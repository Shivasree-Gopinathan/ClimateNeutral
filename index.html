<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Earth Pulse</title>
	<link href="styles/main.css" rel="stylesheet">
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.0/xlsx.full.min.js"></script>

    <!--Side bar-->
  <div class="sidebar" id="sidebar">
  <a href="javascript:void(0)" class="closebutton" onclick="closeSidebar()">X</a>
   <label for="province">Select a province:</label>
  <select name="province" id="province">
    <option value="ontario" selected>Ontario</option>
    <option value="quebec">Quebec</option>
    <option value="newfound">Newfoundland and Labrador</option>
	<option value="prince">Prince Edward Island</option>
    <option value="nova">Nova Scotia</option>
    <option value="brunswick">New Brunswick</option>
	<option value="manitoba">Manitoba</option>
    <option value="saskatchewan">Saskatchewan</option>
	<option value="alberta">Alberta</option>
    <option value="columbia">British Columbia </option>
  </select>
  </div>
  
  <div id="pageBody">
  
  
  <div class="top-bar">
  <button class="openbutton" onclick="openSidebar()">â˜°</button>
      <h1>GreenFleet</h1>
      <a href="#">Data Input</a>
    <a href="#">Green Option</a>
    <a href="#">Results</a>
  </div>
 <!-- <p>Enter Your Data</p> -->
  <div class="button-container">
    <button onclick="Function1()">Download Excel</button>
    <br>
    <button onclick="Function2()">Choose File</button>
  </div>
  <div class="container">
    <br />
    <table id="table-content">
      <tr class="table-tab">
        <td>Description</td>
        <td>Type</td>
        <td>Year</td>
        <td>Make</td>
        <td>Model</td>
        <td>Annual VKT</td>
        <td>Annual Fuel</td>
        <td>Fuel Type</td>
        <td>Fuel Flex</td>
        <td>Quantity</td>
      </tr>
      <tr class="table-input">
        <td><input type="text" id="description" /></td>
        <td>
          <select id="type" class="custom-select">
            <option value=""></option>
            <option value="Car">Car</option>
            <option value="Light Duty Truck">Light Duty Truck</option>
          </select>
        </td>
        <td>
          <select id="year" class="custom-select">
            <option value=""></option>
          </select>
        </td>
        <td><input type="text" id="make" /></td>
        <td><input type="text" id="model" /></td>
        <td><input type="text" id="a_vkt" /></td>
        <td><input type="text" id="a_fuel" /></td>
        <td>
          <select id="f_type" class="custom-select">
            <option value=""></option>
            <option value="Gasoline">Gasoline</option>
            <option value="E10 Gasoline">E10 Gasoline</option>
            <option value="Diesel">Diesel</option>
          </select>
        </td>
        <td>
          <select id="fuel-flex" class="custom-select">
            <option value=""></option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </td>
        <td><input type="text" id="quantity" /></td>
      </tr>
    </table>
    <br />
    <div class="table-btn">
      <button id="add-update-button" onclick="addRow();">Add</button>
      <button onclick="cancelRow();">Cancel</button>
    </div>
	<button onclick="calculateGreenOptions()">Calculate Green Options</button>
  </div>

 <script>
    function Function1() {
      
      alert('Download button clicked!');
    }

    // function Function2() {
      
    //   alert('Upload button clicked!');
    // }

function Function2() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.xlsx';
  input.onchange = function() {
    const file = this.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: 'array' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      
      const table = document.getElementById('table-content');

      // Remove existing rows
      for (let i = table.rows.length - 1; i > 0; i--) {
        table.deleteRow(i);
      }

      // Add new rows from Excel file
      jsonData.slice(1).forEach((row) => {
        const newRow = table.insertRow(-1);
        row.forEach((cellData, index) => {
          const cell = newRow.insertCell(index);
          cell.textContent = cellData;
        });
      });

      // Show input row for manual data entry
      document.querySelector('.table-input').style.display = 'table-row';
    };
    reader.readAsArrayBuffer(file);
  };
  input.click();
}



	function openSidebar() {
  document.getElementById("sidebar").style.width = "250px";
  document.getElementById("pageBody").style.marginLeft = "250px";
}

function closeSidebar() {
  document.getElementById("sidebar").style.width = "0";
  document.getElementById("pageBody").style.marginLeft= "0";
}
  </script>
  <script src="scripts/main.js"></script>
  <script src="scripts/greenOption.js"></script>
  </body>
</html>